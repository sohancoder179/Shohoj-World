<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Shohoj World - Earn Money</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">

<!-- ‡¶π‡ßá‡¶°‡¶æ‡¶∞ -->
<header class="bg-gradient-to-r from-purple-700 to-pink-500 text-white p-4 flex items-center space-x-4 shadow-lg">
    <img id="userPhoto" src="https://via.placeholder.com/50" class="w-12 h-12 rounded-full border-2 border-white"/>
    <div class="flex-1">
        <h1 id="userName" class="text-lg font-bold">Guest User</h1>
        <p id="userUsername" class="text-sm opacity-80">@guest</p>
    </div>
    <div class="text-right">
        <p class="text-xs">‡¶≤‡ßá‡¶≠‡ßá‡¶≤ <span id="userLevel" class="font-bold">1</span></p>
        <div class="w-20 bg-gray-300 rounded-full h-2">
            <div id="levelProgress" class="bg-yellow-400 h-2 rounded-full" style="width: 0%"></div>
        </div>
    </div>
</header>

<main class="p-4 flex-grow max-w-3xl mx-auto w-full space-y-4">
    <!-- ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶ï‡¶æ‡¶∞‡ßç‡¶° -->
    <section class="grid grid-cols-2 sm:grid-cols-4 gap-2">
        <div class="bg-white rounded-xl p-4 shadow text-center">
            <p class="text-sm text-gray-500">‡¶Æ‡ßã‡¶ü ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</p>
            <p id="balance" class="text-2xl font-bold text-purple-700">0.00 ‡ß≥</p>
        </div>
        <div class="bg-white rounded-xl p-4 shadow text-center">
            <p class="text-sm text-gray-500">‡¶Æ‡ßã‡¶ü ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°</p>
            <p id="totalAds" class="text-2xl font-bold text-pink-600">0</p>
        </div>
        <div class="bg-white rounded-xl p-4 shadow text-center">
            <p class="text-sm text-gray-500">‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤</p>
            <p id="totalRefs" class="text-2xl font-bold text-green-600">0</p>
        </div>
        <div class="bg-white rounded-xl p-4 shadow text-center">
            <p class="text-sm text-gray-500">‡¶≤‡ßá‡¶≠‡ßá‡¶≤</p>
            <p id="levelDisplay" class="text-2xl font-bold text-blue-600">1</p>
        </div>
    </section>

    <!-- ‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ -->
    <section class="bg-white p-6 rounded-xl shadow text-center">
        <p class="mb-4 text-lg font-semibold text-gray-600">üéÅ ‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶®‡¶ø‡¶®</p>
        <button id="dailyBonus" class="bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-lg shadow-lg w-full max-w-xs mx-auto">
            <i class="fas fa-gift mr-2"></i>‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ (‡ß´ ‡¶ü‡¶æ‡¶ï‡¶æ)
        </button>
        <p id="bonusTime" class="text-sm text-gray-500 mt-2">‡¶Ü‡¶ó‡¶æ‡¶Æ‡ßÄ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏: 24:00:00</p>
    </section>

    <!-- ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßá ‡¶Ü‡ßü -->
    <section class="bg-white p-6 rounded-xl shadow text-center">
        <p class="mb-4 text-lg font-semibold text-gray-600">üì∫ ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßá ‡¶Ü‡ßü ‡¶ï‡¶∞‡ßÅ‡¶®</p>
        <button id="watchAd" class="bg-purple-700 hover:bg-purple-800 text-white font-bold py-4 px-6 rounded-lg shadow-lg w-full max-w-xs mx-auto">
            <i class="fas fa-play-circle mr-2"></i>‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® (<span id="adRate">0.50</span> ‡¶ü‡¶æ‡¶ï‡¶æ)
        </button>
        <p class="text-xs text-gray-500 mt-2">‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ßß‡ß¶‡¶ü‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡ßá ‡ßß ‡¶≤‡ßá‡¶≠‡ßá‡¶≤ ‡¶Ü‡¶™!</p>
    </section>

    <!-- Monetag Special Ads -->
    <section id="monetagSection" class="bg-yellow-100 border border-yellow-400 p-6 rounded-xl shadow text-center hidden">
        <p class="mb-4 text-lg font-semibold text-yellow-700">üéØ ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶Ö‡¶´‡¶æ‡¶∞! Monetag ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°</p>
        <p class="text-sm text-yellow-600 mb-3" id="monetagMessage">‡¶è‡¶á ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡ßá ‡¶¨‡ßá‡¶∂‡¶ø ‡¶Ü‡ßü ‡¶ï‡¶∞‡ßÅ‡¶®!</p>
        <button id="watchMonetagAd" class="bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-4 px-6 rounded-lg shadow-lg w-full max-w-xs mx-auto">
            <i class="fas fa-star mr-2"></i>Monetag ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® (<span id="monetagEarnings">0.25</span> ‡¶ü‡¶æ‡¶ï‡¶æ)
        </button>
    </section>

    <!-- ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ -->
    <section class="bg-white p-6 rounded-xl shadow">
        <h3 class="text-lg font-bold mb-4 text-center"><i class="fas fa-users mr-2"></i>‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶ï‡ßá ‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
        <p class="mb-2 text-center">‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶ï‡ßá <span id="refBonus" class="text-green-600 font-bold">4.00</span> ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶™‡¶æ‡¶¨‡ßá‡¶®!</p>
        <div class="flex space-x-2 mb-3">
            <input type="text" id="refLink" class="border p-2 rounded flex-1 text-sm" readonly>
            <button onclick="copyRefLink()" class="bg-blue-600 text-white p-2 rounded">
                <i class="fas fa-copy"></i>
            </button>
            <button onclick="shareRefLink()" class="bg-green-600 text-white p-2 rounded">
                <i class="fas fa-share"></i>
            </button>
        </div>
        <div class="text-center">
            <p class="text-sm">‡¶Ü‡¶™‡¶®‡¶ø ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®: <span id="refCount" class="font-bold">0</span> ‡¶ú‡¶®</p>
            <p class="text-xs text-gray-500 mt-1">‡¶¨‡¶®‡ßç‡¶ß‡ßÅ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶¶‡¶ø‡ßü‡ßá ‡¶¨‡¶ü‡ßá ‡¶ú‡ßü‡ßá‡¶® ‡¶ï‡¶∞‡¶≤‡ßá ‡¶Ö‡¶ü‡ßã ‡¶¨‡ßã‡¶®‡¶æ‡¶∏!</p>
        </div>
    </section>

    <!-- ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶§‡ßã‡¶≤‡¶æ‡¶∞ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ -->
    <section class="bg-white p-6 rounded-xl shadow">
        <h3 class="text-lg font-bold mb-4 text-center"><i class="fas fa-wallet mr-2"></i>‡¶ü‡¶æ‡¶ï‡¶æ ‡¶§‡ßÅ‡¶≤‡ßÅ‡¶®</h3>
        <div class="space-y-3">
            <select id="withdrawMethod" class="border p-2 rounded w-full">
                <option value="bkash">bKash</option>
                <option value="nagad">Nagad</option>
                <option value="rocket">Rocket</option>
            </select>
            <input type="text" id="accountNumber" class="border p-2 rounded w-full" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞">
            <input type="number" id="withdrawAmount" class="border p-2 rounded w-full" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ (‡¶®‡ßç‡¶Ø‡ßÇ‡¶®‡¶§‡¶Æ ‡ßß‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ)">
            <button onclick="withdrawMoney()" class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg w-full">
                <i class="fas fa-paper-plane mr-2"></i>‡¶ü‡¶æ‡¶ï‡¶æ ‡¶§‡ßÅ‡¶≤‡ßÅ‡¶®
            </button>
        </div>
    </section>

    <!-- ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ -->
    <section class="bg-white p-6 rounded-xl shadow">
        <h3 class="text-lg font-bold mb-4 text-center"><i class="fas fa-tasks mr-2"></i>‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
        <div class="space-y-3">
            <div class="flex justify-between items-center p-3 border rounded">
                <span><i class="fab fa-telegram mr-2 text-blue-500"></i>Telegram ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶ú‡ßü‡ßá‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</span>
                <button onclick="completeTask('telegram')" class="bg-blue-600 text-white px-3 py-1 rounded text-sm">‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
            <div class="flex justify-between items-center p-3 border rounded">
                <span><i class="fab fa-youtube mr-2 text-red-500"></i>YouTube ‡¶∏‡¶æ‡¶¨‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶æ‡¶á‡¶¨ ‡¶ï‡¶∞‡ßÅ‡¶®</span>
                <button onclick="completeTask('youtube')" class="bg-red-600 text-white px-3 py-1 rounded text-sm">‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
            <div class="flex justify-between items-center p-3 border rounded">
                <span><i class="fab fa-facebook mr-2 text-blue-600"></i>Facebook ‡¶è ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</span>
                <button onclick="completeTask('facebook')" class="bg-blue-600 text-white px-3 py-1 rounded text-sm">‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
        </div>
    </section>

    <!-- ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶° -->
    <section class="bg-white p-6 rounded-xl shadow">
        <h3 class="text-lg font-bold mb-4 text-center"><i class="fas fa-trophy mr-2"></i>‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°</h3>
        <div id="leaderboard" class="space-y-2">
            <div class="text-center text-gray-500">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
        </div>
    </section>
</main>

<script>
// ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ
let user = { 
    id: "guest", 
    name: "Guest", 
    username: "guest", 
    photo: "https://via.placeholder.com/50", 
    balance: 0, 
    totalAds: 0, 
    totalRefs: 0,
    level: 1,
    lastBonus: null,
    completedTasks: [],
    withdrawHistory: [],
    lastMonetagAd: null,
    monetagAdsWatched: 0
};

// Monetag Ad System
let monetagAds = [
    { id: 1, name: "Monetag Premium Ad 1", earnings: 0.25, shown: false },
    { id: 2, name: "Monetag Premium Ad 2", earnings: 0.30, shown: false },
    { id: 3, name: "Monetag Premium Ad 3", earnings: 0.35, shown: false },
    { id: 4, name: "Monetag Premium Ad 4", earnings: 0.40, shown: false },
    { id: 5, name: "Monetag Premium Ad 5", earnings: 0.45, shown: false }
];

// ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶ø‡¶ü‡ßá‡¶ï‡ßç‡¶ü
if (window.Telegram?.WebApp?.initDataUnsafe?.user) {
    let tg = window.Telegram.WebApp.initDataUnsafe.user;
    user.id = tg.id.toString();
    user.name = tg.first_name + (tg.last_name ? " " + tg.last_name : "");
    user.username = tg.username || "guest";
    user.photo = tg.photo_url || "https://via.placeholder.com/50";
}

// UI ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
function updateUI() {
    document.getElementById("userName").innerText = user.name;
    document.getElementById("userUsername").innerText = "@" + user.username;
    document.getElementById("userPhoto").src = user.photo;
    document.getElementById("balance").innerText = user.balance.toFixed(2) + " ‡ß≥";
    document.getElementById("totalAds").innerText = user.totalAds;
    document.getElementById("totalRefs").innerText = user.totalRefs;
    document.getElementById("userLevel").innerText = user.level;
    document.getElementById("levelDisplay").innerText = user.level;
    document.getElementById("refCount").innerText = user.totalRefs;
    
    // ‡¶≤‡ßá‡¶≠‡ßá‡¶≤ ‡¶™‡ßç‡¶∞‡ßã‡¶ó‡ßç‡¶∞‡ßá‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
    let progress = (user.totalAds % 10) * 10;
    document.getElementById("levelProgress").style.width = progress + "%";
    
    generateRefLink();
    updateBonusTimer();
    checkMonetagAd();
}

// Monetag Ad ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
function checkMonetagAd() {
    let monetagSection = document.getElementById("monetagSection");
    let now = new Date().getTime();
    let lastMonetag = user.lastMonetagAd ? new Date(user.lastMonetagAd).getTime() : 0;
    
    // ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ßß‡ß¶‡¶ü‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡ßá ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶∞‚Äç‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶Æ ‡¶∏‡¶Æ‡ßü‡ßá Monetag Ad ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®
    let showMonetag = false;
    let monetagMessage = "";
    
    if (user.totalAds > 0 && user.totalAds % 10 === 0) {
        // ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ßß‡ß¶‡¶ü‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡ßá ‡¶≤‡ßá‡¶≠‡ßá‡¶≤ ‡¶Ü‡¶™ ‡¶è‡¶°
        showMonetag = true;
        monetagMessage = "üéâ ‡¶≤‡ßá‡¶≠‡ßá‡¶≤ ‡¶Ü‡¶™ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏! ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ Monetag ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°";
    } else if (Math.random() < 0.3 && now - lastMonetag > 30 * 60 * 1000) {
        // ‡ß©‡ß¶% ‡¶∏‡¶Æ‡ßç‡¶≠‡¶æ‡¶¨‡¶®‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶∂‡ßá‡¶∑ Monetag Ad ‡¶•‡ßá‡¶ï‡ßá ‡ß©‡ß¶ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶™‡¶∞
        showMonetag = true;
        monetagMessage = "üéØ ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶Ö‡¶´‡¶æ‡¶∞! Monetag ‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡ßü‡¶æ‡¶Æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°";
    }
    
    if (showMonetag) {
        let availableAds = monetagAds.filter(ad => !ad.shown);
        if (availableAds.length === 0) {
            // ‡¶∏‡¶¨ Ads ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡ßü‡ßá ‡¶ó‡ßá‡¶≤‡ßá ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
            monetagAds.forEach(ad => ad.shown = false);
            availableAds = monetagAds;
        }
        
        let randomAd = availableAds[Math.floor(Math.random() * availableAds.length)];
        document.getElementById("monetagEarnings").innerText = randomAd.earnings.toFixed(2);
        document.getElementById("monetagMessage").innerText = monetagMessage;
        monetagSection.classList.remove("hidden");
        
        // Monetag Ad ‡¶¨‡¶æ‡¶ü‡¶® ‡¶è‡¶≠‡ßá‡¶®‡ßç‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®
        document.getElementById("watchMonetagAd").onclick = function() {
            watchMonetagAd(randomAd);
        };
    } else {
        monetagSection.classList.add("hidden");
    }
}

// Monetag Ad ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
function watchMonetagAd(ad) {
    // Monetag Ad ‡¶∏‡¶ø‡¶Æ‡ßÅ‡¶≤‡ßá‡¶∂‡¶®
    let adView = confirm(`üéØ ${ad.name}\n\n‡¶è‡¶á ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ${ad.earnings.toFixed(2)} ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶™‡¶æ‡¶¨‡ßá‡¶®!\n\n‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡¶§‡ßá "OK" ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§`);
    
    if (adView) {
        // ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶°‡¶æ‡¶â‡¶® ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞
        let seconds = 5;
        let timer = setInterval(function() {
            if (seconds > 0) {
                document.getElementById("watchMonetagAd").innerHTML = `<i class="fas fa-spinner fa-spin mr-2"></i>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá... (${seconds}s)`;
                seconds--;
            } else {
                clearInterval(timer);
                
                // ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏
                user.balance += ad.earnings;
                user.totalAds++;
                user.monetagAdsWatched = (user.monetagAdsWatched || 0) + 1;
                user.lastMonetagAd = new Date().toISOString();
                ad.shown = true;
                
                // ‡¶≤‡ßá‡¶≠‡ßá‡¶≤ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
                checkLevelUp();
                
                saveUser();
                updateUI();
                
                alert(`‚úÖ ${ad.name} ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®!\nüí∞ ${ad.earnings.toFixed(2)} ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡ßá‡¶õ‡ßá!\n\n‡¶Æ‡ßã‡¶ü ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏: ${user.balance.toFixed(2)} ‡¶ü‡¶æ‡¶ï‡¶æ`);
            }
        }, 1000);
    }
}

// ‡¶≤‡ßá‡¶≠‡ßá‡¶≤ ‡¶Ü‡¶™ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
function checkLevelUp() {
    let oldLevel = user.level;
    let newLevel = Math.floor(user.totalAds / 10) + 1;
    
    if (newLevel > oldLevel) {
        user.level = newLevel;
        let levelBonus = newLevel * 2; // ‡¶≤‡ßá‡¶≠‡ßá‡¶≤ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏
        user.balance += levelBonus;
        
        alert(`üéâ ‡¶Ö‡¶≠‡¶ø‡¶®‡¶®‡ßç‡¶¶‡¶®! ‡¶Ü‡¶™‡¶®‡¶ø ‡¶≤‡ßá‡¶≠‡ßá‡¶≤ ${newLevel} ‡¶è ‡¶™‡ßå‡¶Å‡¶õ‡ßá‡¶õ‡ßá‡¶®!\n\nüí∞ ‡¶≤‡ßá‡¶≠‡ßá‡¶≤ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏: ${levelBonus} ‡¶ü‡¶æ‡¶ï‡¶æ\n\n‡¶Æ‡ßã‡¶ü ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏: ${user.balance.toFixed(2)} ‡¶ü‡¶æ‡¶ï‡¶æ`);
    }
}

// ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶≤‡¶ø‡¶Ç‡¶ï
function generateRefLink() {
    let botUsername = "Shohoj_World_V3_bot";
    let refLink = `https://t.me/${botUsername}?start=ref${user.id}`;
    document.getElementById("refLink").value = refLink;
}

// ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶ï‡¶™‡¶ø
function copyRefLink() {
    let link = document.getElementById("refLink");
    link.select();
    document.execCommand("copy");
    alert("‚úÖ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶ï‡¶™‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
}

// ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï
function shareRefLink() {
    let link = document.getElementById("refLink").value;
    if (navigator.share) {
        navigator.share({
            title: 'Shohoj World - ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶ï‡¶∞‡ßÅ‡¶®',
            text: '‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡ßá ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ ‡¶ï‡¶∞‡ßÅ‡¶®! ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶≤ ‡¶≤‡¶ø‡¶Ç‡¶ï:',
            url: link
        });
    } else {
        alert("‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶Ö‡¶™‡¶∂‡¶® ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ‡•§ ‡¶≤‡¶ø‡¶Ç‡¶ï‡¶ü‡¶ø ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡ßü‡¶æ‡¶≤‡¶ø ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®:\n" + link);
    }
}

// ‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶¨‡ßã‡¶®‡¶æ‡¶∏
document.getElementById("dailyBonus").addEventListener("click", function() {
    let now = new Date().getTime();
    let lastBonus = user.lastBonus ? new Date(user.lastBonus).getTime() : 0;
    
    if (now - lastBonus >= 24 * 60 * 60 * 1000) {
        user.balance += 5;
        user.lastBonus = new Date().toISOString();
        saveUser();
        updateUI();
        alert(`üéâ ‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶™‡ßá‡ßü‡ßá‡¶õ‡ßá‡¶® ‡ß´ ‡¶ü‡¶æ‡¶ï‡¶æ!`);
    } else {
        alert("‚ö†Ô∏è ‡¶Ü‡¶™‡¶®‡¶ø ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶®‡¶ø‡ßü‡ßá‡¶õ‡ßá‡¶®! ‡¶Ü‡¶ó‡¶æ‡¶Æ‡ßÄ‡¶ï‡¶æ‡¶≤ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
    }
});

// ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞
function updateBonusTimer() {
    let bonusBtn = document.getElementById("dailyBonus");
    let bonusTime = document.getElementById("bonusTime");
    
    if (user.lastBonus) {
        let lastBonusTime = new Date(user.lastBonus).getTime();
        let nextBonusTime = lastBonusTime + (24 * 60 * 60 * 1000);
        let now = new Date().getTime();
        
        if (now < nextBonusTime) {
            let timeLeft = nextBonusTime - now;
            let hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            let minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            let seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            
            bonusTime.innerText = `‡¶Ü‡¶ó‡¶æ‡¶Æ‡ßÄ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏: ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            bonusBtn.disabled = true;
            bonusBtn.classList.add("opacity-50");
        } else {
            bonusTime.innerText = "‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§!";
            bonusBtn.disabled = false;
            bonusBtn.classList.remove("opacity-50");
        }
    } else {
        bonusTime.innerText = "‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§!";
    }
}

// ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶§‡ßã‡¶≤‡¶æ
function withdrawMoney() {
    let method = document.getElementById("withdrawMethod").value;
    let account = document.getElementById("accountNumber").value;
    let amount = parseFloat(document.getElementById("withdrawAmount").value);
    
    if (!account) {
        alert("‚ö†Ô∏è ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¶‡¶ø‡¶®!");
        return;
    }
    
    if (amount < 10) {
        alert("‚ö†Ô∏è ‡¶®‡ßç‡¶Ø‡ßÇ‡¶®‡¶§‡¶Æ ‡ßß‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶§‡ßÅ‡¶≤‡¶§‡ßá ‡¶π‡¶¨‡ßá!");
        return;
    }
    
    if (user.balance < amount) {
        alert("‚ö†Ô∏è ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶Ö‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶§!");
        return;
    }
    
    if (confirm(`‚úÖ ${amount} ‡¶ü‡¶æ‡¶ï‡¶æ ${method} ‡¶è ‡¶§‡ßÅ‡¶≤‡¶¨‡ßá‡¶®?\n\n‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü: ${account}`)) {
        user.balance -= amount;
        user.withdrawHistory.push({
            method: method,
            account: account,
            amount: amount,
            date: new Date().toISOString(),
            status: "pending"
        });
        saveUser();
        alert("‚úÖ ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶π‡ßü‡ßá‡¶õ‡ßá! ‡ß®‡ß™ ‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá‡•§");
        updateUI();
    }
}

// ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®
function completeTask(taskType) {
    if (!user.completedTasks.includes(taskType)) {
        user.completedTasks.push(taskType);
        user.balance += 2; // ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡ß® ‡¶ü‡¶æ‡¶ï‡¶æ
        saveUser();
        updateUI();
        alert(`‚úÖ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®! ‡ß® ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶™‡ßá‡ßü‡ßá‡¶õ‡ßá‡¶®!`);
    } else {
        alert("‚ö†Ô∏è ‡¶Ü‡¶™‡¶®‡¶ø ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶è‡¶á ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï‡¶ü‡¶ø ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®!");
    }
}

// ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶≤‡ßã‡¶°
function loadLeaderboard() {
    // GitHub Pages ‡¶è JSON ‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶°
    fetch('./users.json')
        .then(response => response.json())
        .then(users => {
            let leaderboard = Object.values(users)
                .sort((a, b) => b.balance - a.balance)
                .slice(0, 5);
            
            let leaderboardHTML = "";
            leaderboard.forEach((user, index) => {
                let medal = "";
                if (index === 0) medal = "ü•á";
                else if (index === 1) medal = "ü•à";
                else if (index === 2) medal = "ü•â";
                
                leaderboardHTML += `
                    <div class="flex justify-between items-center p-3 border-b">
                        <div class="flex items-center space-x-2">
                            <span class="font-bold">${medal} ${index + 1}.</span>
                            <img src="${user.photo}" class="w-8 h-8 rounded-full">
                            <span class="truncate max-w-20">${user.name}</span>
                        </div>
                        <span class="font-bold text-purple-700">${user.balance.toFixed(2)} ‡ß≥</span>
                    </div>
                `;
            });
            
            if (leaderboard.length === 0) {
                leaderboardHTML = `<p class="text-center text-gray-500">‡¶è‡¶ñ‡¶®‡¶ì ‡¶ï‡ßã‡¶® ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡ßá‡¶á</p>`;
            }
            
            document.getElementById("leaderboard").innerHTML = leaderboardHTML;
        })
        .catch(error => {
            console.log('GitHub users.json load failed, using localStorage');
            // Fallback to localStorage
            let localUsers = JSON.parse(localStorage.getItem('shohoj_users')) || {};
            let leaderboard = Object.values(localUsers)
                .sort((a, b) => b.balance - a.balance)
                .slice(0, 5);
            
            let leaderboardHTML = "";
            leaderboard.forEach((user, index) => {
                leaderboardHTML += `
                    <div class="flex justify-between items-center p-3 border-b">
                        <div class="flex items-center space-x-2">
                            <span class="font-bold">${index + 1}.</span>
                            <span>${user.name}</span>
                        </div>
                        <span class="font-bold text-purple-700">${user.balance.toFixed(2)} ‡ß≥</span>
                    </div>
                `;
            });
            
            document.getElementById("leaderboard").innerHTML = leaderboardHTML || '<p class="text-center text-gray-500">‡¶è‡¶ñ‡¶®‡¶ì ‡¶ï‡ßã‡¶® ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡ßá‡¶á</p>';
        });
}

// ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶∏‡ßá‡¶≠ (GitHub Pages ‡¶≠‡¶æ‡¶∞‡ßç‡¶∏‡¶®)
function saveUser() {
    // localStorage ‡¶è ‡¶∏‡ßá‡¶≠
    let users = JSON.parse(localStorage.getItem('shohoj_users')) || {};
    users[user.id] = user;
    localStorage.setItem('shohoj_users', JSON.stringify(users));
    
    // ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ (‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶π‡¶≤‡ßá)
    if (user.id === "7231743379") {
        console.log("Admin data saved to localStorage");
    }
}

// ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶≤‡ßã‡¶° (GitHub Pages ‡¶≠‡¶æ‡¶∞‡ßç‡¶∏‡¶®)
function loadUser() {
    // ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá localStorage ‡¶ö‡ßá‡¶ï
    let localUsers = JSON.parse(localStorage.getItem('shohoj_users')) || {};
    if (localUsers[user.id]) {
        user = {...user, ...localUsers[user.id]};
        updateUI();
        return;
    }
    
    // Fallback: GitHub users.json
    fetch('./users.json')
        .then(r => r.json())
        .then(users => {
            if (users[user.id]) {
                user = {...user, ...users[user.id]};
                updateUI();
            }
        })
        .catch(error => {
            console.log('Both localStorage and GitHub failed');
        });
}

// ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶≤‡ßã‡¶°
function loadSettings() {
    // GitHub ‡¶•‡ßá‡¶ï‡ßá settings ‡¶≤‡ßã‡¶°
    fetch('./zone.json')
        .then(r => r.json())
        .then(settings => {
            document.getElementById("adRate").innerText = (settings.adRate || 0.50).toFixed(2);
            document.getElementById("refBonus").innerText = (settings.refBonus || 4.00).toFixed(2);
        })
        .catch(error => {
            // Fallback to default
            document.getElementById("adRate").innerText = "0.50";
            document.getElementById("refBonus").innerText = "4.00";
        });
}

// ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡ßü‡¶æ‡¶≤ ‡¶≤‡ßã‡¶°
document.addEventListener('DOMContentLoaded', function() {
    loadUser();
    loadLeaderboard();
    loadSettings();
    
    // ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
    setInterval(updateBonusTimer, 1000);
    
    // ‡¶ú‡ßã‡¶® ‡¶≤‡ßã‡¶° (‡¶Ø‡¶¶‡¶ø ‡¶•‡¶æ‡¶ï‡ßá)
    fetch('./zone.json')
        .then(r => r.json())
        .then(data => {
            if (data.zoneId && window.showGiga) {
                let script = document.createElement("script");
                script.src = `https://ad.gigapub.tech/script?id=${data.zoneId}`;
                document.body.appendChild(script);
            }
        });
});

// ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶™‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
document.getElementById("watchAd").addEventListener("click", () => {
    // Ad rate from settings or default
    let adRate = 0.50;
    
    if (window.showGiga) {
        window.showGiga().then(() => {
            user.totalAds++;
            user.balance += adRate;
            
            // ‡¶≤‡ßá‡¶≠‡ßá‡¶≤ ‡¶Ü‡¶™ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
            checkLevelUp();
            // Monetag Ad ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
            checkMonetagAd();
            
            saveUser();
            updateUI();
        }).catch(() => {
            // Fallback for testing
            user.totalAds++;
            user.balance += adRate;
            checkLevelUp();
            checkMonetagAd();
            saveUser();
            updateUI();
            alert(`‚úÖ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®! ${adRate.toFixed(2)} ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶™‡ßá‡ßü‡ßá‡¶õ‡ßá‡¶®!`);
        });
    } else {
        // Direct fallback
        user.totalAds++;
        user.balance += adRate;
        checkLevelUp();
        checkMonetagAd();
        saveUser();
        updateUI();
        alert(`‚úÖ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®! ${adRate.toFixed(2)} ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶™‡ßá‡ßü‡ßá‡¶õ‡ßá‡¶®!`);
    }
});
</script>
</body>
</html>